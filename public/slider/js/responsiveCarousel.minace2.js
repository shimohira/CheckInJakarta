/*! responsiveCarousel.JS - v1.2.0
 * http://basilio.github.com/responsiveCarousel
 *
 * Copyright (c) 2013 Basilio CÃ¡ceres <basilio.caceres@gmail.com>;
 * Licensed under the MIT license */(function(e){"use strict";e.fn.carousel=function(t){var n,r;n={infinite:!0,visible:1,speed:"fast",overflow:!1,autoRotate:!1,navigation:e(this).data("navigation"),itemMinWidth:0,itemEqualHeight:!1,itemMargin:0,itemClassActive:"crsl-active",imageWideClass:"wide-image",carousel:!0,isGallery:!1};return e(this).each(function(){r=e(this);e.isEmptyObject(t)===!1&&e.extend(n,t);e.isEmptyObject(e(r).data("crsl"))===!1&&e.extend(n,e(r).data("crsl"));n.isTouch="ontouchstart"in document.documentElement||navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)?!0:!1;r.init=function(){n.total=e(r).find(".crsl-item").length;n.itemWidth=e(r).outerWidth();if(n.isGallery==0){n.activeWidth=e(".container-center").width();n.nextWidth=e(".sidebar").width()}n.visibleDefault=n.visible;n.swipeDistance=null;n.swipeMinDistance=100;n.startCoords={};n.endCoords={};e(r).css({width:"100%"});e(r).find(".crsl-item").css({position:"relative","float":"left",overflow:"hidden",height:"auto"});e(r).find("."+n.imageWideClass).each(function(){e(this).css({display:"block",width:"100%",height:"auto"})});e(r).find(".crsl-item iframe").attr({width:"100%"});n.carousel&&e(r).find(".crsl-item:first-child").addClass(n.itemClassActive);n.carousel&&n.infinite&&n.visible<n.total&&e(r).find(".crsl-item:first-child").before(e(".crsl-item:last-child",r));n.overflow===!1?e(r).css({overflow:"hidden"}):e("html, body").css({"overflow-x":"hidden"});e(r).trigger("initCarousel",[n,r]);r.testPreload();r.config();r.initRotate();r.triggerNavs()};r.testPreload=function(){if(e(r).find("img").length>0){var t=e(r).find("img").length,i=1;e(r).find("img").each(function(){r.preloadImage(this,i,t);i++})}else e(r).trigger("loadedCarousel",[n,r])};r.preloadImage=function(t,i,s){var o=new Image,u={};u.src=e(t).attr("src")!==undefined?t.src:"";u.alt=e(t).attr("alt")!==undefined?t.alt:"";e(o).attr(u);e(o).on("load",function(){i===1&&e(r).trigger("loadingImagesCarousel",[n,r]);i===s&&e(r).trigger("loadedImagesCarousel",[n,r])})};r.config=function(){n.itemWidth=Math.floor((e(r).outerWidth()-n.itemMargin*(n.visibleDefault-1))/n.visibleDefault);if(n.itemWidth<=n.itemMinWidth){n.visible=Math.floor((e(r).outerWidth()-n.itemMargin*(n.visible-1))/n.itemMinWidth)===1?Math.floor(e(r).outerWidth()/n.itemMinWidth):Math.floor((e(r).outerWidth()-n.itemMargin)/n.itemMinWidth);n.visible=n.visible<1?1:n.visible;n.itemWidth=n.visible===1?Math.floor(e(r).outerWidth()):Math.floor((e(r).outerWidth()-n.itemMargin*(n.visible-1))/n.visible)}else n.visible=n.visibleDefault;if(n.carousel){r.wrapWidth=Math.floor((n.itemWidth+n.itemMargin)*n.total+200);r.wrapMargin=r.wrapMarginDefault=n.infinite&&n.visible<n.total?parseInt((n.itemWidth+n.itemMargin)*-1,10):0;if(n.infinite&&n.visible<n.total&&e(r).find(".crsl-item."+n.itemClassActive).index()===0){e(r).find(".crsl-item:first-child").before(e(".crsl-item:last-child",r));r.wrapMargin=r.wrapMarginDefault=parseInt((n.itemWidth+n.itemMargin)*-1,10)}e(r).find(".crsl-wrap").css({width:r.wrapWidth+"px",marginLeft:r.wrapMargin})}else{r.wrapWidth=e(r).outerWidth();e(r).find(".crsl-wrap").css({width:r.wrapWidth+n.itemMargin+"px"});e("#"+n.navigation).hide()}e(r).find(".crsl-item").css({width:n.itemWidth+"px",marginRight:n.itemMargin+"px"});if(n.isGallery==0){e(r).find(".crsl-active").css({width:n.activeWidth});e(r).find(".crsl-active").next(".crsl-item").css({width:n.nextWidth})}r.equalHeights();if(n.carousel)if(n.visible>=n.total){n.autoRotate=!1;e("#"+n.navigation).hide()}else e("#"+n.navigation).show()};r.equalHeights=function(){if(n.itemEqualHeight!==!1){var t=0;e(r).find(".crsl-item").each(function(){e(this).css({height:"auto"});e(this).outerHeight()>t&&(t=e(this).outerHeight())});e(r).find(".crsl-item").css({height:t+"px"})}return!0};r.initRotate=function(){n.autoRotate!==!1&&(r.rotateTime=window.setInterval(function(){r.rotate()},n.autoRotate))};r.triggerNavs=function(){e("#"+n.navigation).delegate(".previous, .next","click",function(t){t.preventDefault();r.prepareExecute();if(e(this).hasClass("previous")&&r.testPrevious(r.itemActive))r.previous();else{if(!e(this).hasClass("next")||!r.testNext())return;r.next()}})};r.prepareExecute=function(){n.autoRotate&&clearInterval(r.rotateTime);r.preventAnimateEvent();r.itemActive=e(r).find(".crsl-item."+n.itemClassActive);return!0};r.preventAnimateEvent=function(){if(e(r).find(".crsl-wrap:animated").length>0)return!1};r.rotate=function(){r.preventAnimateEvent();r.itemActive=e(r).find(".crsl-item."+n.itemClassActive);r.next();return!0};r.testPrevious=function(t){return e(".crsl-wrap",r).find(".crsl-item").index(t)>0};r.testNext=function(){return!n.infinite&&r.wrapWidth>=(n.itemWidth+n.itemMargin)*(n.visible+1)-r.wrapMargin||n.infinite};r.previous=function(){r.wrapMargin=n.infinite?r.wrapMarginDefault+e(r.itemActive).outerWidth(!0):r.wrapMargin+e(r.itemActive).outerWidth(!0);var t=e(r.itemActive).index(),i=e(r.itemActive).prev(".crsl-item"),s="previous";e(".carousel-control").hide();e(r).trigger("beginCarousel",[n,r,s]);if(n.isGallery==0){e(r.itemActive).animate({width:n.nextWidth},n.speed);e(r.itemActive).next(".crsl-item").animate({width:n.itemWidth},n.speed);e(i).animate({width:n.activeWidth},n.speed)}n.isGallery==0?e(r).find(".crsl-wrap").animate({marginLeft:r.wrapMargin-n.nextWidth/2-10+"px"},n.speed,function(){e(r.itemActive).removeClass(n.itemClassActive);e(i).addClass(n.itemClassActive);if(n.infinite)e(this).css({marginLeft:r.wrapMarginDefault}).find(".crsl-item:first-child").before(e(".crsl-item:last-child",r));else{r.testPrevious(i)===!1&&e("#"+n.navigation).find(".previous").addClass("previous-inactive");r.testNext()&&e("#"+n.navigation).find(".next").removeClass("next-inactive")}e(this).trigger("endCarousel",[n,r,s]);e(".carousel-control").delay(n.speed+20).show()}):e(r).find(".crsl-wrap").animate({marginLeft:r.wrapMargin+"px"},n.speed,function(){e(r.itemActive).removeClass(n.itemClassActive);e(i).addClass(n.itemClassActive);if(n.infinite)e(this).css({marginLeft:r.wrapMarginDefault}).find(".crsl-item:first-child").before(e(".crsl-item:last-child",r));else{r.testPrevious(i)===!1&&e("#"+n.navigation).find(".previous").addClass("previous-inactive");r.testNext()&&e("#"+n.navigation).find(".next").removeClass("next-inactive")}e(this).trigger("endCarousel",[n,r,s]);e(".carousel-control").delay(n.speed+40).show()})};r.next=function(){r.wrapMargin=n.infinite?r.wrapMarginDefault-e(r.itemActive).outerWidth(!0):r.wrapMargin-e(r.itemActive).outerWidth(!0);var t=e(r.itemActive).index(),i=e(r.itemActive).next(".crsl-item"),s="next";e(".carousel-control").hide();e(r).trigger("beginCarousel",[n,r,s]);if(n.isGallery==0){e(r.itemActive).animate({width:n.itemWidth},n.speed);e(i).animate({width:n.activeWidth},n.speed);e(i).next(".crsl-item").animate({width:n.nextWidth},n.speed)}n.isGallery==0?e(r).find(".crsl-wrap").animate({marginLeft:r.wrapMargin+n.nextWidth/2+10+"px"},n.speed,function(){e(r.itemActive).removeClass(n.itemClassActive);e(i).addClass(n.itemClassActive);if(n.infinite)e(this).css({marginLeft:r.wrapMarginDefault}).find(".crsl-item:last-child").after(e(".crsl-item:first-child",r));else{r.testPrevious(i)&&e("#"+n.navigation).find(".previous").removeClass("previous-inactive");r.testNext()===!1&&e("#"+n.navigation).find(".next").addClass("next-inactive")}e(this).trigger("endCarousel",[n,r,s]);e(".carousel-control").delay(n.speed+20).show()}):e(r).find(".crsl-wrap").animate({marginLeft:r.wrapMargin+"px"},n.speed,function(){e(r.itemActive).removeClass(n.itemClassActive);e(i).addClass(n.itemClassActive);if(n.infinite)e(this).css({marginLeft:r.wrapMarginDefault}).find(".crsl-item:last-child").after(e(".crsl-item:first-child",r));else{r.testPrevious(i)&&e("#"+n.navigation).find(".previous").removeClass("previous-inactive");r.testNext()===!1&&e("#"+n.navigation).find(".next").addClass("next-inactive")}e(this).trigger("endCarousel",[n,r,s]);e(".carousel-control").delay(n.speed+20).show()})};var i=!1,s;e(window).on("mouseleave",function(t){t.target?s=t.target:t.srcElement&&(s=t.srcElement);e(r).attr("id")&&e(s).parents(".crsl-items").attr("id")===e(r).attr("id")||e(s).parents(".crsl-items").data("navigation")===e(r).data("navigation")?i=!0:i=!1;return!1});e(window).on("keydown",function(e){if(i===!0)if(e.keyCode===37){r.prepareExecute();r.previous()}else if(e.keyCode===39){r.prepareExecute();r.next()}return});n.isTouch&&e(r).on("touchstart",function(t){e(r).addClass("touching");n.startCoords.pageX=n.endCoords.pageX=t.originalEvent.targetTouches[0].pageX;n.startCoords.pageY=n.endCoords.pageY=t.originalEvent.targetTouches[0].pageY;e(".touching").on("touchmove",function(e){n.endCoords.pageX=e.originalEvent.targetTouches[0].pageX;n.endCoords.pageY=e.originalEvent.targetTouches[0].pageY;if(Math.abs(parseInt(n.endCoords.pageX-n.startCoords.pageX,10))>Math.abs(parseInt(n.endCoords.pageY-n.startCoords.pageY,10))){e.preventDefault();e.stopPropagation()}})}).on("touchend",function(t){t.preventDefault();t.stopPropagation();n.swipeDistance=n.endCoords.pageX-n.startCoords.pageX;n.swipeDistance>=n.swipeMinDistance?r.previous():n.swipeDistance<=-n.swipeMinDistance&&r.next();e(".touching").off("touchmove").removeClass("touching")});e(r).on("loadedCarousel loadedImagesCarousel",function(){r.equalHeights()});e(window).on("carouselResizeEnd",function(){n.itemWidth!==e(r).outerWidth()&&r.config()});e(window).ready(function(){e(r).trigger("prepareCarousel",[n,r]);r.init();e(window).on("resize",function(){this.carouselResizeTo&&clearTimeout(this.carouselResizeTo);this.carouselResizeTo=setTimeout(function(){e(this).trigger("carouselResizeEnd")},10)})});e(window).load(function(){r.testPreload();r.config()})})}})(jQuery);